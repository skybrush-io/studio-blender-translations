# Skybrush Studio for Blender Translations

This repository is the main source of translations for [Skybrush Studio for Blender](https://github.com/skybrush-io/studio-blender).

The structure of the repository is similar to the main [blender-translations](https://github.com/blender/blender-translations) repository.

## How to translate strings?

This repo is connected to Weblate, a cooperative translation frontend. Translation should be performed on the [Skybrush Studio for Blender translation website](https://translate.skybrush.io/projects/skybrush/studio/) accordingly, where all the languages supported by Blender should be listed.

## How to push translations of this repo to Skybrush Studio for Blender?

Merging new translations with our add-on is done by the Skybrush team when new translations are mature enough for an update. If you wish to see your new translations in action, you can test the plugin with the following procedure:

1. Open Blender with the "Skybrush Studio for Blender" add-on loaded
2. Setup the "Manage UI translations" add-on properly in "Edit" / "Preferences" / "Add-ons":
    1. clone the official [blender](https://github.com/blender) and [blender-translations](https://github.com/blender/blender-translations) sources from GitHub (`--depth 1` is enough in `git clone`)
    2. link them to the "Source Root" and "Translation Root" directories
    3. save settings to a proper "Persistent data path" as settings might be lost on next Blender execution
3. In "Properties" panel / "Render" / "I18n Update Translation" press the "Import PO..." button under the "Add-ons" section:
    1. select this repository's `po` directory for the PO inputs/outputs
    2. wait for the translation add-on to import translations and automatically export them to the skybrush add-on's code.
    3. cut the auto-generated `translations_tuple` section in the `studio-blender` add-on from `ui_skybrush_studio.py` and replace the old version in `src/modules/sbstudio/i18n/translations.py` with the new one (search for the string `AUTOGENERATED I18N SECTION`).
    4. finally, it is recommended to run `ruff format src/modules/sbstudio/i18n/translations.py` to have the new translations in the same format as before, with changes reflecting only the real content change

## How to pull translation source from Skybrush Studio for Blender to this repo?

Updating translation source of this repo is done by the Skybrush team from time to time when a new **Skybrush Studio for Blender** version is released. The procedure is the following (there are more intuitive alternatives but this one ensures minimal superfluous change in the output):

1. Temporarily copy the auto-generated `translations-tuple` section from `src/modules/sbstudio/i18n/translations.py` to the end of `ui_skybrush_studio.py`.
2. Open Blender.
3. Press the "Refresh I18n Data..." button in the "Manage UI translations" add-on.
4. Press the "Export PO..." button in the "Manage UI translations" add-on and select this repo's `po` folder for exporting the new files.
5. Finally, perform steps 3.3 and 3.4 from the previous section to have a synchronized translation database in the `skybrush-studio-blender` and `skybrush-studio-blender-translations` repositories.

**WARNING**: Note that the "Manage UI translations" addon in Blender 4.4 and 4.5 (and actually main as of 2025.11.04.) does not handle string extraction from custom panels and menus properly, so the official version of `scripts/modules/_bl_i18n_utils/bl_extract_messages.py` of Blender need to be patched by this PR: https://github.com/blender/blender/pull/102/ for the time being.

**WARNING**: Also note that our custom classes that are defined based on some of our custom base classes (e.g. `class TransitionEditorIntoCurrentFormation(TransitionEditorBase)`) are also mishandled by the translation plugin as these base classes are not registered on their own and thus the translation plugin cannot detect them as related to the Skybrush addon, hence some related strings are also not extracted for the time being.